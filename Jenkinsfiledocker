
node{
	stage('Checkout'){
		//Checkout the code from a GitHub repository
		git 'https://github.com/vijaybirru/hello-world.git'
	}
	stage('build'){
		sh '"/opt/maven/bin/mvn" -V clean compile'
	}
               stage('test'){
		sh '"/opt/maven/bin/mvn" -V clean test'
	}
	stage('package'){
		sh '"/opt/maven/bin/mvn" -V clean package'
	}
	 stage('Deploy to devserver-docker'){
		 sshagent(['xnxnxnxn']) {
			 sh 'scp -o StrictHostKeyChecking=no target/*.war ec2-user@54.202.126.109:/opt/dock'
			 sh ' docker build -t kammana/my-app:2.0.0 /opt/dock/.'
			 sh ' docker run -p 8080:8080 -d --name my-app kammana/my-app:2.0.0'
      }
}
}
